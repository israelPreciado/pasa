<!--#include file="funcion3/funcion.inc"-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link href="css3/bootstrap.min.css" rel="stylesheet" type="text/css">
<link href="style.css" rel="stylesheet" type="text/css">
<link rel="stylesheet" href="css4/styleMenuSwipeable.css" type="text/css" media="screen" charset="utf-8">
<link rel="stylesheet" href="css3/animate.css">
  <link href="css3/login2.css" rel="stylesheet" type="text/css">
<style>
.datagrid table { border-collapse: collapse; text-align: left; width: 100%; } .datagrid {font: normal 12px/150% Arial, Helvetica, sans-serif; background: #fff; overflow: hidden; border: 1px solid #991821; -webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; }.datagrid table td, .datagrid table th { padding: 3px 10px; }.datagrid table thead th {background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #991821), color-stop(1, #80141C) );background:-moz-linear-gradient( center top, #991821 5%, #80141C 100% );filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#991821', endColorstr='#80141C');background-color:#991821; color:#FFFFFF; font-size: 15px; font-weight: bold; border-left: 1px solid #B01C26; } .datagrid table thead th:first-child { border: none; }.datagrid table tbody td { color: #80141C; border-left: 1px solid #F7CDCD;font-size: 12px;font-weight: normal; }.datagrid table tbody .alt td { background: #F7CDCD; color: #80141C; }.datagrid table tbody td:first-child { border-left: none; }.datagrid table tbody tr:last-child td { border-bottom: none; }.datagrid table tfoot td div { border-top: 1px solid #991821;background: #F7CDCD;} .datagrid table tfoot td { padding: 0; font-size: 12px } .datagrid table tfoot td div{ padding: 2px; }.datagrid table tfoot td ul { margin: 0; padding:0; list-style: none; text-align: right; }.datagrid table tfoot  li { display: inline; }.datagrid table tfoot li a { text-decoration: none; display: inline-block;  padding: 2px 8px; margin: 1px;color: #FFFFFF;border: 1px solid #991821;-webkit-border-radius: 3px; -moz-border-radius: 3px; border-radius: 3px; background:-webkit-gradient( linear, left top, left bottom, color-stop(0.05, #991821), color-stop(1, #80141C) );background:-moz-linear-gradient( center top, #991821 5%, #80141C 100% );filter:progid:DXImageTransform.Microsoft.gradient(startColorstr='#991821', endColorstr='#80141C');background-color:#991821; }.datagrid table tfoot ul.active, .datagrid table tfoot ul a:hover { text-decoration: none;border-color: #80141C; color: #FFFFFF; background: none; background-color:#991821;}div.dhtmlx_window_active, div.dhx_modal_cover_dv { position: fixed !important; }
}
</style>  
  <script src="js/jquery.min.js"></script>
  <script src="js/bootstrap.min.js"></script>
  	<script type="text/javascript" src="http://code.jquery.com/jquery-1.9.1.js"></script>
	<script type="text/javascript" src="js/jsplug.js"></script>
  <script language="javascript">
  
  function territorios(){
	document.getElementById('frm_revisarAvance').action="modalTest_territorial.asp"
	document.getElementById('frm_revisarAvance').submit()
	//cambiarClase2()	
}
function supervisores(){
	document.getElementById('frm_revisarAvance').action="modalTest_supervisores.asp"
	document.getElementById('frm_revisarAvance').submit()
	//cambiarClase2()	
}
function contratistas(){
	document.getElementById('frm_revisarAvance').action="modalTest_contratistas.asp"
	document.getElementById('frm_revisarAvance').submit()
	//cambiarClase2()	
}

  </script>
<!-- inicio 112 script necesario para que se ejecute el datatable-->
<style type="text/css" title="currentStyle">
			@import "DataTables/media/css/jquery.dataTables.min.css";
			@import "DataTables/media/css/dataTables.jqueryui.min.css";
			@import "DataTables/media/css/jquery-ui.css";
</style>
<script type="text/javascript" language="javascript" src="DataTables/media/js/jquery.dataTables.js"></script>
<script src="DataTables/media/js/jquery.dataTables.columnFilter.js" type="text/javascript"></script>
<script src="DataTables/media/js/jquery.dataTables.min.js" type="text/javascript"></script>
<script src="DataTables/media/js/dataTables.jqueryui.min.js" type="text/javascript"></script>
<script>
//funcion para poner estilo a la tabla principal
var subtotal8=0
$(document).ready(function() {
    $('#example1').DataTable( {
		
		"paging": false,
        "ordering": true,
        "info":     false,
		"searching": false,
		"lengthMenu": [[5, 10, 25, 50, -1], [5, 10, 25, 50, "All"]],
		"oLanguage": {
		  "sSearch":         "Buscar:",
		  "sInfo": "Mostrando del _START_ al _END_ de _TOTAL_ registros",
		  "sInfoEmpty":      "Mostrando 0 registros",
		  "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
		  "sEmptyTable":     "Ningún servicio adicional",
		  "sZeroRecords":    "No se encontraron resultados",
		  "sLengthMenu": "Mostrar _MENU_ Registros",
      	  "oPaginate": {
       	    "sNext": "Pagina Siguiente",
			"sPrevious": "Pagina Anterior"
						}
					 }  
    } );
	 $('#example2').DataTable( {
		
		"paging": false,
        "ordering": true,
        "info":     false,
		"searching": false,
		"lengthMenu": [[5, 10, 25, 50, -1], [5, 10, 25, 50, "All"]],
		"oLanguage": {
		  "sSearch":         "Buscar:",
		  "sInfo": "Mostrando del _START_ al _END_ de _TOTAL_ registros",
		  "sInfoEmpty":      "Mostrando 0 registros",
		  "sInfoFiltered":   "(filtrado de un total de _MAX_ registros)",
		  "sEmptyTable":     "Ningúna Sucursal Encontrada",
		  "sZeroRecords":    "No se encontraron resultados",
		  "sLengthMenu": "Mostrar _MENU_ Registros",
      	  "oPaginate": {
       	    "sNext": "Pagina Siguiente",
			"sPrevious": "Pagina Anterior"
						}
					 }  
    } );
	
	

} );

function showDetalleAvance(supervisor,mes,anio){

	document.getElementById('supervisor').value=supervisor
		document.getElementById('mes').value=mes
			document.getElementById('anio').value=anio
	document.getElementById('frm_revisarAvance').action="modalTest_terr_supervisor_paso2_ConMenuSwip.asp"
	document.getElementById('frm_revisarAvance').submit()
	
}

function regresar(){
<%if session.contents("pagina")="1" then%>
document.getElementById('frm_revisarAvance').action="revisar_avanceGraficas_conMenuSwip.asp"
<%else%>
document.getElementById('frm_revisarAvance').action="modalTest_supervisores_ConMenuSwip.asp"
<%end if%>
	
	document.getElementById('frm_revisarAvance').submit()
	//cambiarClase2()	
}
</script>
<!-- fin 112-->

<title>Documento sin título</title>

</head>
<%
On Error Resume Next
territorial=request("territorial")
query=request("query")
anio="2018"
estatusObra=request("estatusObra")
%>
<%
if isempty(session("xmd")) then
response.Redirect("default.asp?logout=true")
end if
%>
<body> 
<form name="frm_revisarAvance" id="frm_revisarAvance" method="get" enctype="multipart/form-data">
<input type="hidden" id="cr" name="cr"/>
<input type="hidden" id="mes" name="mes"/>
<input type="hidden" id="anio" name="anio"/>
<input type="hidden" id="supervisor" name="supervisor"/>
<input type="hidden" name="estatus1" id="estatus1"/>
<input type="hidden" name="estatus2" id="estatus2"/>
<input type="hidden" id="query" name="query" value="<%=query%>"/>
<input type="hidden" name="estatusObra" id="estatusObra" value="<%=estatusObra%>"/>
<input type="hidden" name="territorial" id="territorial" value="<%=territorial%>"/>
<input type="hidden" id="regional" name="regional"/>
<div class="container">
    <div id="sidebar">
        <ul>
        <li><a href="revisar_avanceGraficas_ConMenuSwip.asp" target = "contenido" style="text-decoration:none">Home</a></li>
            <li><a href="busqueda_ConMenuSwip.asp" target = "contenido" style="text-decoration:none">Buscar un CR</a></li>
            <li><a href="revisar_avance_ConMenuSwip.asp" target = "contenido" style="text-decoration:none">Avance General</a></li>
			<li><a href="controlAcciones_proyGral_ConMenuSwip.asp" target = "contenido" style="text-decoration:none">Proyecto General</a></li>
            <li><a href="controlAccionesTacticas_ConMenuSwip.asp">Acciones T&aacute;cticas</a></li>
        </ul>
    </div>
    <div class="main-content">
    <div class="swipe-area"></div>
        <a href="#" data-toggle=".container" id="sidebar-toggle">
            <span class="bar"></span>
            <span class="bar"></span>
            <span class="bar"></span>
        </a>
        <div class="content">
            <div class="animated zoomIn">

<!-- DIRECTOR NACIONAL-->
<% if session.contents("zonaDirector")="" then%>	
<!-- empieza el contenido-->			
<table width="90%" align="center">
 <tr><td>
<div class="datagrid">
<table cellpadding="0" cellspacing="0" class="display" id="example1">
<thead>
	<tr>
		<th width="13%">Supervisor</th><th width="6%">ENE</th><th width="6%">FEB</th><th width="6%">MAR</th><th width="6%">ABR</th><th width="6%">MAY</th><th width="6%">JUN</th><th width="6%">JUL</th><th width="6%">AGO</th><th width="6%">SEP</th><th width="6%">OCT</th><th width="6%">NOV</th><th width="6%">DIC</th><th width="6%">TP</th>
	</tr>
</thead>
<tfoot>
   <tr>
    <th  style="text-align:center">TOTAL</th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "enero",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "enero",query,estatusObra))>0 then%> onclick="showDetalleAvance('','01','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"enero",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "febrero",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "febrero",query,estatusObra))>0 then%> onclick="showDetalleAvance('','02','2018')" <%end if%>><%=numeroSupTerrMes(territorial, "febrero",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "marzo",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "marzo",query,estatusObra))>0 then%> onclick="showDetalleAvance('','03','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"marzo",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "abril",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "abril",query,estatusObra))>0 then%> onclick="showDetalleAvance('','04','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"abril",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "mayo",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "mayo",query,estatusObra))>0 then%> onclick="showDetalleAvance('','05','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"mayo",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "junio",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "junio",query,estatusObra))>0 then%> onclick="showDetalleAvance('','06','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"junio",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "julio",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "julio",query,estatusObra))>0 then%> onclick="showDetalleAvance('','07','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"julio",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "agosto",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "agosto",query,estatusObra))>0 then%> onclick="showDetalleAvance('','08','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"agosto",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "septiembre",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "septiembre",query,estatusObra))>0 then%> onclick="showDetalleAvance('','09','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"septiembre",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "octubre",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "octubre",query,estatusObra))>0 then%> onclick="showDetalleAvance('','10','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"octubre",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "noviembre",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "noviembre",query,estatusObra))>0 then%> onclick="showDetalleAvance('','11','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"noviembre",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMes(territorial, "diciembre",query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMes(territorial, "diciembre",query,estatusObra))>0 then%> onclick="showDetalleAvance('','12','2018')" <%end if%>><%=numeroSupTerrMes(territorial,"diciembre",query,estatusObra)%></th>
	<th  style="text-align:center;<%if cint(numeroSucTerrRegional(territorial,query,estatusObra))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSucTerrRegional(territorial,query,estatusObra))>0 then%> onclick="showDetalleAvance('','','2018')" <%end if%>><%=numeroSucTerrRegional(territorial,query,estatusObra)%></th>
   </tr>
</tfoot>
<tbody>
<%
set conn3=server.CreateObject("adodb.connection")
set rs1=server.CreateObject("adodb.recordset")
conn3.open connstr
if estatusObra="autorizadas" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c on a.cr=c.cr where c.Territorial ='" & territorial & "' GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c on a.cr=c.cr GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31'  GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30'  GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31'  GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
if estatusObra="terminadas" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
if estatusObra="enProceso" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
if estatusObra="porIniciar" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
rs1.open sql1, conn3
if rs1.eof then
	rs1.close
	conn3.close
else
while not (rs1.eof)

%>
<tr><td align="center" ><font color="#000000"><%=rs1("supervisor")%></font></td>
<td  style="text-align:center;<%if cint(rs1("enero"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("enero"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','01','2018')" <%end if%>"><font color="#000000"><%=rs1("enero")%></font></td>
<td  style="text-align:center;<%if cint(rs1("febrero"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("febrero"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','02','2018')" <%end if%>"><font color="#000000"><%=rs1("febrero")%></font></td>
<td  style="text-align:center;<%if cint(rs1("marzo"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("marzo"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','03','2018')" <%end if%>"><font color="#000000"><%=rs1("marzo")%></font></td>
<td  style="text-align:center;<%if cint(rs1("abril"))>0 then%>cursor:pointer;<%end if%>" <%if cint(rs1("abril"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','04','2018')" <%end if%>"><font color="#000000"><%=rs1("abril")%></font></td>
<td  style="text-align:center;<%if cint(rs1("mayo"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("mayo"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','05','2018')" <%end if%>"><font color="#000000"><%=rs1("mayo")%></font></td>
<td  style="text-align:center;<%if cint(rs1("junio"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("junio"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','06','2018')" <%end if%>"><font color="#000000"><%=rs1("junio")%></font></td>
<td  style="text-align:center;<%if cint(rs1("julio"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("julio"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','07','2018')" <%end if%>"><font color="#000000"><%=rs1("julio")%></font></td>
<td  style="text-align:center;<%if cint(rs1("agosto"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("agosto"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','08','2018')" <%end if%>"><font color="#000000"><%=rs1("agosto")%></font></td>
<td  style="text-align:center;<%if cint(rs1("septiembre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("septiembre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','09','2018')" <%end if%>"><font color="#000000"><%=rs1("septiembre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("octubre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("octubre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','10','2018')" <%end if%>"><font color="#000000"><%=rs1("octubre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("noviembre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("noviembre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','11','2018')" <%end if%>"><font color="#000000"><%=rs1("noviembre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("diciembre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("diciembre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','12','2018')" <%end if%>"><font color="#000000"><%=rs1("diciembre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("total"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("total"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','','2018')" <%end if%>"><font color="#000000"><%=rs1("total")%></font></td></tr>
<%

rs1.movenext
	wend 
rs1.close
conn3.close 
set rs1=nothing
set conn3=nothing
end if 
%> 
</tbody>
</table>
</td>
</tr>
<table>
<br/>
   <table width="40%" align="center">
     <tr>
     <td width="10%">&nbsp;</td>
      <td width="20%"><input  type="button" value="Regresar" onclick="regresar()" name="btnEnviar" /></td>
      <td width="10%">&nbsp;</td>
     </tr>
    </table>
  <br/>
<br/>
<!-- Termina el contenido-->

<!-- DIRECTOR DIVISIONAL-->	
<%else%>
<!-- empieza el contenido-->			
<table width="90%" align="center">
 <tr><td>
<div class="datagrid">
<table cellpadding="0" cellspacing="0" class="display" id="example1">
<thead>
	<tr>
		<th width="13%">Supervisor</th><th width="6%">ENE</th><th width="6%">FEB</th><th width="6%">MAR</th><th width="6%">ABR</th><th width="6%">MAY</th><th width="6%">JUN</th><th width="6%">JUL</th><th width="6%">AGO</th><th width="6%">SEP</th><th width="6%">OCT</th><th width="6%">NOV</th><th width="6%">DIC</th><th width="6%">TP</th>
	</tr>
</thead>
<tfoot>
   <tr>
    <th  style="text-align:center">TOTAL</th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "enero",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "enero",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','01','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"enero",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "febrero",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "febrero",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','02','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial, "febrero",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "marzo",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "marzo",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','03','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"marzo",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "abril",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "abril",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','04','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"abril",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "mayo",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "mayo",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','05','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"mayo",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "junio",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "junio",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','06','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"junio",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "julio",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "julio",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','07','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"julio",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "agosto",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "agosto",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','08','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"agosto",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "septiembre",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "septiembre",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','09','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"septiembre",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "octubre",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "octubre",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','10','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"octubre",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "noviembre",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "noviembre",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','11','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"noviembre",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSupTerrMesZona(territorial, "diciembre",query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSupTerrMesZona(territorial, "diciembre",query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','12','2018')" <%end if%>><%=numeroSupTerrMesZona(territorial,"diciembre",query,estatusObra,session.contents("zonaDirector"))%></th>
	<th  style="text-align:center;<%if cint(numeroSucTerrRegionalZona(territorial,query,estatusObra,session.contents("zonaDirector")))>0 then%>cursor:pointer<%end if%>" <%if cint(numeroSucTerrRegionalZona(territorial,query,estatusObra,session.contents("zonaDirector")))>0 then%> onclick="showDetalleAvance('','','2018')" <%end if%>><%=numeroSucTerrRegionalZona(territorial,query,estatusObra,session.contents("zonaDirector"))%></th>
   </tr>
</tfoot>
<tbody>
<%
set conn3=server.CreateObject("adodb.connection")
set rs1=server.CreateObject("adodb.recordset")
conn3.open connstr
if estatusObra="autorizadas" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c on a.cr=c.cr where c.Territorial ='" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' AND c.Territorial = '" & territorial & "' and c.zona_territorial='" & session.contents("zonaDirector") & "' GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c on a.cr=c.cr where c.zona_territorial='" & session.contents("zonaDirector") & "' GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'   GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'   GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'   GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'   GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-12-01' AND '" & anio & "-12-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
if estatusObra="terminadas" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-12-01' AND '" & anio & "-12-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr where c.zona_territorial='" & session.contents("zonaDirector") & "' GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-12-01' AND '" & anio & "-12-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 3 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
if estatusObra="enProceso" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' and c.zona_territorial='" & session.contents("zonaDirector") & "' AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-12-01' AND '" & anio & "-12-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND (a.EstatusObra = 1 or a.EstatusObra =2) GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr where c.zona_territorial='" & session.contents("zonaDirector") & "' GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-12-01' AND '" & anio & "-12-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND (a.EstatusObra = 1 or a.EstatusObra = 2) GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
if estatusObra="porIniciar" then
 if query="1" then
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-12-01' AND '" & anio & "-12-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND c.Territorial = '" & territorial & "' AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado" 
 else
  sql1="SELECT supervisores.supervisorAsignado, supervisores.supervisor, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END AS ENERO, CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END AS FEBRERO, CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END AS MARZO, CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END AS ABRIL, CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END AS MAYO, CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END AS JUNIO, CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END AS JULIO, CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END AS AGOSTO, CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END AS SEPTIEMBRE, CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END AS OCTUBRE, CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END AS NOVIEMBRE, CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS DICIEMBRE, CASE WHEN ENERO.total IS NULL THEN 0 ELSE ENERO.total END + CASE WHEN FEBRERO.total IS NULL THEN 0 ELSE FEBRERO.total END + CASE WHEN MARZO.total IS NULL THEN 0 ELSE MARZO.total END + CASE WHEN ABRIL.total IS NULL THEN 0 ELSE ABRIL.total END + CASE WHEN MAYO.total IS NULL THEN 0 ELSE MAYO.total END + CASE WHEN JUNIO.total IS NULL THEN 0 ELSE JUNIO.total END + CASE WHEN JULIO.total IS NULL THEN 0 ELSE JULIO.total END + CASE WHEN AGOSTO.total IS NULL THEN 0 ELSE AGOSTO.total END + CASE WHEN SEPTIEMBRE.total IS NULL THEN 0 ELSE SEPTIEMBRE.total END + CASE WHEN OCTUBRE.total IS NULL THEN 0 ELSE OCTUBRE.total END + CASE WHEN NOVIEMBRE.total IS NULL THEN 0 ELSE NOVIEMBRE.total END + CASE WHEN DICIEMBRE.total IS NULL THEN 0 ELSE DICIEMBRE.total END AS TOTAL FROM( SELECT a.supervisorAsignado, b.login_nombre supervisor FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr where c.zona_territorial='" & session.contents("zonaDirector") & "' GROUP BY a.supervisorAsignado) AS supervisores LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-01-01' AND '" & anio & "-01-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ENERO ON supervisores.supervisorAsignado = ENERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-02-01' AND '" & anio & "-02-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS FEBRERO ON supervisores.supervisorAsignado = FEBRERO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-03-01' AND '" & anio & "-03-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MARZO ON supervisores.supervisorAsignado = MARZO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-04-01' AND '" & anio & "-04-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS ABRIL ON supervisores.supervisorAsignado = ABRIL.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-05-01' AND '" & anio & "-05-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS MAYO ON supervisores.supervisorAsignado = MAYO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-06-01' AND '" & anio & "-06-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JUNIO ON supervisores.supervisorAsignado = JUNIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-07-01' AND '" & anio & "-07-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS JULIO ON supervisores.supervisorAsignado = JULIO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-08-01' AND '" & anio & "-08-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS AGOSTO ON supervisores.supervisorAsignado = AGOSTO.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-09-01' AND '" & anio & "-09-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS SEPTIEMBRE ON supervisores.supervisorAsignado = SEPTIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-10-01' AND '" & anio & "-10-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS OCTUBRE ON supervisores.supervisorAsignado = OCTUBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-11-01' AND '" & anio & "-11-30' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS NOVIEMBRE ON supervisores.supervisorAsignado = NOVIEMBRE.supervisorAsignado LEFT JOIN( SELECT a.supervisorAsignado, b.login_nombre, COUNT(*) AS total, c.Territorial FROM tseguimiento a LEFT JOIN app_bnrt_login b ON a.supervisorAsignado = b.login_id LEFT JOIN cat_sucursales c ON a.cr = c.cr WHERE FechaInicio BETWEEN '" & anio & "-12-01' AND '" & anio & "-12-31' and c.zona_territorial='" & session.contents("zonaDirector") & "'  AND a.EstatusObra = 0 GROUP BY b.login_nombre) AS DICIEMBRE ON supervisores.supervisorAsignado = DICIEMBRE.supervisorAsignado"
 end if
end if
rs1.open sql1, conn3
if rs1.eof then
	rs1.close
	conn3.close
else
while not (rs1.eof)

%>
<tr><td align="center" ><font color="#000000"><%=rs1("supervisor")%></font></td>
<td  style="text-align:center;<%if cint(rs1("enero"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("enero"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','01','2018')" <%end if%>"><font color="#000000"><%=rs1("enero")%></font></td>
<td  style="text-align:center;<%if cint(rs1("febrero"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("febrero"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','02','2018')" <%end if%>"><font color="#000000"><%=rs1("febrero")%></font></td>
<td  style="text-align:center;<%if cint(rs1("marzo"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("marzo"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','03','2018')" <%end if%>"><font color="#000000"><%=rs1("marzo")%></font></td>
<td  style="text-align:center;<%if cint(rs1("abril"))>0 then%>cursor:pointer;<%end if%>" <%if cint(rs1("abril"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','04','2018')" <%end if%>"><font color="#000000"><%=rs1("abril")%></font></td>
<td  style="text-align:center;<%if cint(rs1("mayo"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("mayo"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','05','2018')" <%end if%>"><font color="#000000"><%=rs1("mayo")%></font></td>
<td  style="text-align:center;<%if cint(rs1("junio"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("junio"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','06','2018')" <%end if%>"><font color="#000000"><%=rs1("junio")%></font></td>
<td  style="text-align:center;<%if cint(rs1("julio"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("julio"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','07','2018')" <%end if%>"><font color="#000000"><%=rs1("julio")%></font></td>
<td  style="text-align:center;<%if cint(rs1("agosto"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("agosto"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','08','2018')" <%end if%>"><font color="#000000"><%=rs1("agosto")%></font></td>
<td  style="text-align:center;<%if cint(rs1("septiembre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("septiembre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','09','2018')" <%end if%>"><font color="#000000"><%=rs1("septiembre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("octubre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("octubre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','10','2018')" <%end if%>"><font color="#000000"><%=rs1("octubre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("noviembre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("noviembre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','11','2018')" <%end if%>"><font color="#000000"><%=rs1("noviembre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("diciembre"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("diciembre"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','12','2018')" <%end if%>"><font color="#000000"><%=rs1("diciembre")%></font></td>
<td  style="text-align:center;<%if cint(rs1("total"))>0 then%>cursor:pointer<%end if%>" <%if cint(rs1("total"))>0 then%> onclick="showDetalleAvance('<%=rs1("supervisorAsignado")%>','','2018')" <%end if%>"><font color="#000000"><%=rs1("total")%></font></td></tr>
<%

rs1.movenext
	wend 
rs1.close
conn3.close 
set rs1=nothing
set conn3=nothing
end if 

If Err.Number <> 0 Then

  Response.Write (sql1)   

  Response.End 

End If

On Error GoTo 0
%> 
</tbody>
</table>
</td>
</tr>
<table>
<br/>
   <table width="40%" align="center">
     <tr>
     <td width="10%">&nbsp;</td>
      <td width="20%"><input  type="button" value="Regresar" onclick="regresar()" name="btnEnviar" /></td>
      <td width="10%">&nbsp;</td>
     </tr>
    </table>
  <br/>
<br/>
<!-- Termina el contenido-->	
<%end if%>
  <br/>
    </div>
    </div>
</div>
<input type="hidden" name="hddn_estatus1" id="hddn_estatus1" />
<input type="hidden" name="hddn_estatus2" id="hddn_estatus2" />
<input type="hidden" name="hddn_territorial" id="hddn_territorial" />
</form>
</body>
</html>





