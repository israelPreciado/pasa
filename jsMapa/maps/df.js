/*!
 *
 * Jquery Mapael - Dynamic maps jQuery plugin (based on raphael.js)
 * Requires jQuery and Mapael
 *
 * Map of USA by state
 * 
 * @source http://the55.net/_11/sketch/us_map
 */
(function (factory) {
    if (typeof exports === 'object') {
        // CommonJS
        module.exports = factory(require('jquery'), require('mapael'));
    } else if (typeof define === 'function' && define.amd) {
        // AMD. Register as an anonymous module.
        define(['jquery', 'mapael'], factory);
    } else {
        // Browser globals
        factory(jQuery, jQuery.mapael);
    }
}(function ($, Mapael) {

    "use strict";
    
    $.extend(true, Mapael,
        {
            maps :{
                usa_states : {
                    width : 959,
                    height : 1093,
                    latLngToGrid: function(lat, lng, phi1, phi2, midLng, scale) {
                        var pi =Math.PI
                            , midLat = (phi1 + phi2) / 2
                            , n, tmp1, tmp2, tmp3, x, y, p;

                        n = (Math.sin(phi1 / 180 * pi) + Math.sin(phi2 / 180 * pi)) / 2;
                        tmp1 = Math.sqrt(Math.cos(phi1 / 180 * pi)) + 2 * n * Math.sin(phi1 / 180 * pi);
                        tmp2 = scale * Math.pow(tmp1 - 2 * n * Math.sin(midLat / 180 * pi),0.5) / n;
                        tmp3 = n * (lng - midLng);
                        p = scale * Math.pow(tmp1 - 2 * n * Math.sin(lat / 180 * pi),0.5) / n;
                        x = p * Math.sin(tmp3 / 180 * pi);
                        y = tmp2 - p * Math.cos(tmp3 / 180 * pi);
                        
                        return([x,y]);
                    },
                    getCoords : function (lat, lon) {
                        var coords = {},
                            xOffset,
                            yOffset,
                            scaleX,
                            scaleY,
                            phi1,
                            phi2,
                            midLng,
                            scale;
                        if(lat > 51) { // alaska
                            phi1= 15;
                            phi2= 105;
                            midLng = -134;
                            scale = 530;
                            coords = this.latLngToGrid(lat, lon, phi1, phi2, midLng, scale);
                            xOffset = 190;
                            yOffset = 543;
                            scaleX= 1;
                            scaleY= -1;

                        } else if (lon < -140) { // hawaii
                            phi1= 0;
                            phi2= 26;
                            midLng = -166;
                            scale = 1280;
                            coords = this.latLngToGrid(lat, lon, phi1, phi2, midLng, scale);
                            xOffset = 115;
                            yOffset = 723;
                            scaleX= 1;
                            scaleY= -1;
                        } else {
                            xOffset = -17;
                            yOffset = -22;
                            scaleX = 10.05;
                            scaleY = 6.26;

                            coords[0] = 50.0 + 124.03149777329222 * ((1.9694462586094064-(lat* Math.PI / 180)) * Math.sin(0.6010514667026994 * (lon + 96) * Math.PI / 180));
                            coords[1] = 50.0 + 1.6155950752393982 * 124.03149777329222 * 0.02613325650382181 - 1.6155950752393982* 124.03149777329222 * (1.3236744353715044- (1.9694462586094064-(lat* Math.PI / 180)) * Math.cos(0.6010514667026994 * (lon + 96) * Math.PI / 180));
                        }
                        return {x : (coords[0] * scaleX + xOffset), y : (coords[1] * scaleY + yOffset)};
                    },
                    elems : {
                        "MILPAALTA": "M 413,890,420,895,427,899,432,902,438,906,441,908,445,911,451,915,457,919,463,922,469,925,475,929,482,933,488,937,493,939,498,943,503,946,508,948,511,951,515,954,519,956,521,957,521,958,527,951,531,946,535,941,538,937,541,933,545,928,550,925,553,920,558,916,561,912,566,909,569,906,573,905,576,902,580,900,585,899,588,899,593,900,598,902,603,904,606,905,609,907,613,909,617,910,621,912,625,914,630,914,633,916,638,919,641,921,646,923,650,924,653,925,653,926,660,915,664,907,671,891,670,880,668,873,666,866,664,856,663,848,660,842,665,836,671,828,676,821,679,813,683,810,673,795,670,778,682,760,680,753,675,748,672,738,673,727,674,718,677,710,672,706,668,701,664,696,660,690,657,685,653,679,649,675,644,677,636,679,630,682,624,685,618,687,611,690,603,693,598,695,595,696,591,700,588,705,586,710,583,713,577,714,572,715,565,716,560,716,555,717,553,717,548,722,543,729,537,732,532,736,527,738,522,742,515,746,509,750,503,753,499,756,492,758,487,761,481,763,475,766,470,768,464,770,459,773,452,777,446,780,441,782,436,784,434,785,430,784,427,781,423,774,420,770,420,767,416,767,411,766,407,767,405,774,403,780,400,786,398,791,396,795,394,798,392,804,388,810,386,813,385,815,383,818,380,820,380,821,381,822,383,822,384,823,389,824,390,825,392,829,392,835,392,837,392,841,391,846,391,848,392,853,393,859,395,866,399,869,402,871,405,876,407,880,409,882,412,886 Z",
						"TLALPAN": "M 280,882,286,882,296,882,303,883,310,883,317,884,324,884,329,884,336,886,343,886,353,886,361,887,369,887,377,887,387,887,394,888,401,889,413,889,412,885,409,882,406,878,404,874,402,870,396,867,394,865,393,860,392,853,391,847,391,843,392,838,392,831,391,828,390,824,386,823,383,822,381,821,380,820,382,818,385,814,388,809,391,805,394,798,396,793,399,786,402,781,404,777,405,772,406,768,408,766,409,766,415,767,418,767,419,767,420,771,421,772,423,774,425,778,428,773,428,766,427,760,427,753,425,747,425,745,424,739,421,736,417,732,411,729,405,726,399,723,399,719,401,712,405,708,408,703,411,698,417,691,420,686,424,679,428,675,431,669,434,664,435,661,439,657,440,649,439,644,438,638,436,631,436,625,436,623,437,621,440,624,445,626,447,626,452,626,455,626,460,625,463,624,468,623,474,622,478,619,484,618,490,614,498,611,498,607,495,602,493,598,489,598,481,599,478,599,473,595,467,590,462,585,459,579,458,577,453,575,450,579,449,580,444,583,439,586,432,588,425,589,420,589,415,595,411,599,408,600,403,601,396,601,393,600,387,601,377,601,375,603,369,604,362,603,357,599,352,594,349,588,344,586,338,583,334,583,329,585,324,585,319,584,316,579,312,579,307,579,302,582,297,587,294,595,292,599,291,603,290,607,289,612,289,618,288,624,287,627,284,645,280,652,275,658,270,664,263,670,258,677,251,681,244,687,239,691,234,694,229,695,224,695,215,696,210,696,203,696,196,694,190,692,184,689,179,688,176,688,170,689,164,691,157,694,153,694,154,703,154,708,155,714,158,722,163,730,166,735,171,744,172,748,179,763,182,771,184,776,188,789,189,797,193,809,194,814,196,819,200,825,205,830,213,837,229,848,235,853,243,859 Z",
						"MAGDALENACONTRERAS": "M 153,695,152,685,152,678,151,671,153,669,154,668,154,665,154,663,152,661,150,660,149,659,149,658,153,655,153,653,161,646,166,643,168,640,172,638,176,634,177,632,181,630,182,628,181,621,183,616,185,612,188,610,193,610,199,610,202,609,204,610,207,608,209,606,211,600,213,595,214,590,216,588,215,581,217,577,219,575,221,574,224,574,228,573,231,573,234,570,238,565,240,560,242,555,243,548,246,542,248,536,250,531,252,529,258,522,261,519,267,519,270,518,273,520,278,521,283,525,285,527,288,528,291,528,296,527,302,526,307,526,313,525,319,524,321,524,327,523,330,526,328,530,326,534,323,539,321,542,317,545,313,551,310,556,308,561,307,566,307,570,307,575,307,580,303,583,298,587,296,589,294,595,292,600,291,603,290,608,289,611,289,616,288,621,288,624,287,627,286,631,286,635,285,640,284,645,283,648,280,653,273,661,267,667,261,673,258,678,254,680,249,683,244,687,236,693,231,695,223,696,217,697,212,697,204,696,197,695,190,692,184,689,179,688,175,688 Z",
						"COYOACAN": "M 321,540,324,540,328,538,331,536,338,532,341,527,341,522,344,516,347,513,350,507,354,502,360,499,362,496,365,490,370,490,374,489,376,489,377,484,377,480,382,478,385,479,390,481,391,481,394,481,397,483,399,484,402,489,404,489,409,490,415,486,417,485,420,486,425,487,426,489,429,490,431,491,432,490,438,485,441,481,442,479,449,478,449,482,449,490,449,497,449,503,449,509,449,515,448,517,449,522,450,527,450,529,454,533,457,538,458,539,461,541,463,543,468,544,471,543,475,545,477,546,481,548,485,553,489,559,490,560,492,565,493,566,495,571,495,573,496,578,496,580,496,586,495,589,495,593,494,597,493,599,490,598,483,598,477,598,471,593,464,587,460,581,459,576,457,575,453,575,449,579,444,582,440,585,436,587,433,587,427,589,421,589,416,593,410,599,402,601,395,600,387,601,378,601,373,603,369,604,363,603,360,602,356,598,351,593,346,587,342,585,338,583,335,583,330,584,327,584,324,585,320,584,318,583,316,580,314,579,306,578,306,568,307,562,309,555,313,548,317,544,322,539 Z",
						"BENITOJUAREZ": "M 423,383,423,388,423,392,423,396,424,402,424,410,424,413,425,421,426,427,427,428,428,432,428,437,429,442,429,445,429,450,431,453,432,455,432,461,432,468,432,473,432,476,432,480,432,483,432,489,430,490,427,489,421,486,416,485,409,489,403,489,400,487,397,483,394,481,390,481,387,480,382,478,377,481,376,486,374,489,365,490,364,486,363,481,359,477,354,474,348,478,343,481,339,484,333,485,324,478,328,473,330,469,332,464,326,460,321,457,317,454,318,451,324,446,336,438,336,431,336,422,337,415,333,416,326,421,321,420,319,418,321,410,323,403,329,403,333,404,338,403,344,403,353,402,358,401,363,399,368,398,375,397,379,395,387,392 Z",
						"CUAUHTEMOC": "M 359,401,360,394,360,385,360,375,362,368,362,361,362,353,363,346,363,338,364,331,364,324,364,317,364,308,364,302,366,297,364,292,361,287,360,285,363,282,365,280,371,281,373,282,374,285,382,289,388,290,389,291,394,288,397,285,402,281,405,277,405,275,411,275,419,273,422,272,427,271,433,271,438,270,443,269,446,268,448,268,448,276,448,284,448,290,448,298,449,306,449,314,449,322,449,330,449,339,448,345,448,353,448,362,448,367,448,372,448,378,439,379,433,380,425,382,423,383,417,384,411,384,411,386,405,387 Z",
						"VENUSTIANOCARRANZA": "M 447,377,453,376,461,376,468,375,472,374,480,373,481,373,483,370,485,365,489,360,491,357,498,352,504,347,511,344,516,339,522,334,528,330,533,325,538,321,543,316,546,314,547,311,543,308,537,305,533,302,527,299,523,296,518,292,513,288,508,285,503,281,496,278,489,274,483,272,476,269,471,267,463,265,454,266,448,267,448,272,448,278,448,286,448,293,448,299,448,305,448,313,447,322,448,330,448,338,448,347,448,355,447,361,447,366,448,371 Z",
						"ALVAROOBREGON": "M 216,387,187,417,167,432,168,436,168,438,171,442,175,446,179,449,181,450,186,452,188,453,194,454,201,456,206,459,210,460,214,461,218,462,223,463,229,464,235,467,237,468,241,470,244,470,248,472,251,475,251,478,251,482,247,488,243,492,238,497,233,503,229,507,223,513,219,518,214,523,208,530,203,536,198,541,193,545,189,550,184,557,179,562,175,566,170,571,166,575,163,580,159,585,154,590,149,596,144,603,143,607,142,612,142,619,141,625,141,631,141,637,141,644,141,649,141,654,141,657,144,656,149,659,153,653,161,647,166,643,168,641,173,638,177,632,180,630,181,630,182,627,181,624,181,619,184,614,185,613,188,610,195,610,203,610,206,608,208,606,211,599,213,593,214,589,216,586,215,579,219,575,223,574,231,573,237,565,240,559,242,553,243,549,246,541,248,535,250,530,252,528,256,523,261,519,270,518,272,519,278,521,284,526,288,528,295,527,300,526,306,526,313,525,319,524,324,523,327,523,329,525,328,529,326,532,324,535,322,538,322,539,324,540,328,538,332,536,337,532,339,530,341,525,341,521,344,515,347,513,350,506,354,503,359,499,361,496,363,494,364,490,364,485,363,481,360,478,354,474,351,476,349,477,343,482,339,484,337,485,333,485,326,480,324,477,327,474,330,468,332,464,317,454,320,449,324,445,333,440,336,437,336,428,336,421,337,416,331,417,329,418,327,420,327,420,322,419,319,417,320,413,321,409,323,403,320,401,318,399,312,400,310,402,304,405,299,407,293,407,287,407,281,410,275,413,271,417,270,420,266,422,262,424,259,422,255,420 Z",
						"CUAJIMALPADEMORELOS": "M 141,655,136,656,131,653,125,649,121,643,119,640,115,638,111,635,105,635,104,630,97,622,109,612,119,600,126,592,123,583,116,581,106,580,92,577,80,575,72,566,69,566,66,562,64,557,64,550,66,547,70,542,74,538,79,533,83,528,82,523,81,519,80,515,77,509,82,504,87,499,92,493,95,491,100,485,104,482,107,479,109,473,110,468,111,466,110,457,114,454,116,451,118,448,118,445,118,443,117,441,116,440,115,438,116,437,118,436,119,437,120,437,122,437,123,435,124,433,125,433,126,434,126,435,126,437,130,437,131,438,133,439,135,439,138,439,139,439,142,436,142,430,142,427,145,425,149,423,153,422,155,423,155,424,156,425,157,425,158,425,159,425,161,424,162,423,163,423,164,424,164,425,165,425,165,426,165,428,165,429,165,429,165,430,165,431,167,432,168,437,171,442,175,445,180,449,186,451,189,452,197,453,201,455,207,458,214,460,218,461,224,463,230,464,235,465,237,467,241,469,244,469,248,471,251,475,251,481,247,486,243,491,238,496,233,502,228,506,224,512,218,517,213,523,208,528,203,534,198,539,193,543,189,548,184,555,179,561,174,565,170,570,166,575,163,579,158,584,154,590,149,594,144,601,142,604,142,615,141,622,141,629,141,635 Z",
						"TLAHUAC": "M 541,607,545,609,554,614,563,618,571,621,579,627,586,634,590,637,594,640,601,645,605,649,611,653,616,657,617,659,616,664,612,669,608,676,605,681,601,687,597,691,595,695,594,696,604,693,616,688,624,686,631,682,637,680,644,678,649,676,654,681,657,687,659,690,664,697,668,703,671,706,676,711,681,705,687,699,695,693,700,685,695,676,687,662,678,647,670,634,661,617,666,597,668,583,671,564,673,551,675,535,678,518,680,503,676,503,669,506,663,509,659,512,652,512,647,514,641,517,634,519,629,522,623,525,618,528,612,529,606,532,600,535,596,537,589,539,585,541,578,543,571,546,563,548,557,549,556,556,557,561,556,564,556,569,556,576,556,582 Z",
						"XOCHIMILCO": "M 425,777,427,773,428,767,427,759,426,753,424,744,423,740,419,736,411,731,404,727,399,724,399,719,401,712,405,708,408,702,412,696,417,690,421,683,425,678,428,675,431,668,434,662,439,657,439,653,438,646,436,634,435,627,435,624,436,622,441,625,445,626,455,626,463,624,469,623,475,621,479,619,485,617,491,614,497,611,504,613,516,613,531,612,541,608,549,612,557,616,573,622,586,635,592,638,601,645,606,649,612,653,616,657,616,663,613,668,609,675,604,681,600,688,595,696,588,705,583,713,575,714,556,716,552,718,547,725,537,733,526,739,514,748,501,755,483,763,474,767,463,771,455,776,444,782,434,786 Z",
						"IZTAPALAPA": "M 681,502,661,511,647,515,635,520,619,527,608,531,601,535,598,538,595,538,580,543,574,546,568,547,562,549,556,550,558,560,557,568,556,583,556,585,556,612,548,629,509,612,498,610,493,598,495,585,495,577,493,570,489,560,483,553,480,549,475,546,469,544,467,545,461,543,455,537,448,528,447,520,448,507,448,492,448,483,448,470,448,463,448,461,453,458,464,456,472,454,483,451,485,437,486,429,493,421,497,416,503,415,522,414,526,413,529,407,532,399,534,393,536,385,537,384,571,395,595,404,608,409,624,413,638,430,658,458,670,473,677,483,682,492 Z",
						"IZTACALCO": "M 431,493,431,480,431,469,430,457,428,446,427,438,426,432,425,427,423,419,423,410,423,402,422,395,421,383,425,381,437,379,448,377,458,376,468,374,475,373,481,371,485,365,488,360,493,356,503,348,511,343,517,338,522,334,528,329,533,324,538,320,545,314,549,312,551,318,550,325,546,332,544,337,537,356,537,384,536,391,533,399,531,405,529,409,527,414,524,416,515,416,509,416,503,417,499,418,489,428,486,434,486,441,485,450,485,452,475,456,466,458,458,460,452,460,450,464,449,470,449,476,449,478,443,481,439,485,435,491 Z",

						"GUSTAVOAMADERO": "M 367,208,366,198,365,192,354,182,349,180,348,175,350,172,343,167,346,163,360,168,367,169,369,169,371,156,374,152,374,145,366,137,369,130,368,123,378,112,383,111,392,94,399,82,406,73,416,70,424,64,433,70,436,76,443,80,445,90,443,95,446,107,446,113,443,121,438,130,431,140,430,146,429,152,425,161,431,169,438,175,442,180,447,185,453,187,458,188,467,188,476,191,485,192,492,198,500,201,503,201,504,209,509,219,514,226,517,233,520,239,523,246,527,252,531,258,534,265,532,274,534,280,538,289,542,299,545,306,548,312,535,304,529,299,520,293,483,273,473,269,463,266,459,265,448,267,448,268,442,269,437,271,431,272,425,272,421,273,413,274,408,275,404,275,400,267,397,259,393,253,390,244,387,238,385,233,382,227,378,219,376,214,374,212 Z",
						
						"AZCAPOTZALCO": "M 288,278,292,268,287,262,281,259,284,247,288,243,288,238,293,226,294,219,298,210,301,200,308,193,318,196,328,200,337,204,345,206,350,202,367,207,374,212,378,219,383,228,388,239,391,247,396,257,399,263,402,271,404,275,405,278,401,281,397,285,393,289,389,291,384,289,380,287,374,284,373,281,367,280,364,280,361,285,362,289,365,293,365,296,365,297,360,298,355,299,351,299,346,297,342,298,336,298,330,297,327,292,325,286,325,280,319,279,316,280,313,283,311,285,310,285,307,280,303,277,300,275,296,278 Z",
						"MIGUELHIDALGO": "M 216,388,225,381,235,371,244,361,256,351,262,350,268,341,271,336,273,328,272,327,265,323,257,317,257,315,261,313,268,310,273,305,277,303,282,292,286,285,288,277,295,276,300,275,307,281,310,284,316,279,324,279,325,287,328,293,330,296,336,297,345,297,348,297,351,298,356,298,362,296,364,296,365,296,364,302,364,306,364,311,364,316,364,320,364,327,363,335,363,344,362,350,362,358,362,366,361,373,360,381,360,386,360,394,359,400,359,402,355,403,350,403,347,404,342,403,336,404,329,404,323,404,318,399,314,401,309,403,303,406,297,408,292,407,288,408,284,409,278,413,274,416,271,420,269,422,266,424,261,426,258,423,254,420,251,416,248,414,243,410,238,405,234,401,228,397 Z"
						 
						 
                        
                    }
                }
            }
        }
    );

    return Mapael;

}));